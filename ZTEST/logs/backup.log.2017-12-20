ERROR RootSystem-akka.actor.default-dispatcher-6 org.apache.spark.SparkContext - Error initializing SparkContext.
org.apache.spark.SparkException: Detected yarn cluster mode, but isn't running on a cluster. Deployment to YARN is not supported directly by SparkContext. Please use spark-submit.
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:377)
	at org.apache.spark.SparkContext$.getOrCreate(SparkContext.scala:2278)
	at org.apache.spark.sql.SparkSession$Builder$$anonfun$8.apply(SparkSession.scala:831)
	at org.apache.spark.sql.SparkSession$Builder$$anonfun$8.apply(SparkSession.scala:823)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession$Builder.getOrCreate(SparkSession.scala:823)
	at youe.data.scala.drivers.EtlDriver2$.<init>(EtlDriver2.scala:23)
	at youe.data.scala.drivers.EtlDriver2$.<clinit>(EtlDriver2.scala)
	at youe.data.service.job.TaskUtil$.<init>(TaskUtil.scala:22)
	at youe.data.service.job.TaskUtil$.<clinit>(TaskUtil.scala)
	at youe.data.service.job.DataHandler$$anonfun$receive$1.applyOrElse(DataHandler.scala:44)
	at akka.actor.Actor$class.aroundReceive(Actor.scala:484)
	at youe.data.service.job.DataHandler.aroundReceive(DataHandler.scala:17)
	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:526)
	at akka.actor.ActorCell.invoke(ActorCell.scala:495)
	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:257)
	at akka.dispatch.Mailbox.run(Mailbox.scala:224)
	at akka.dispatch.Mailbox.exec(Mailbox.scala:234)
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
ERROR RootSystem-akka.actor.default-dispatcher-6 org.apache.spark.SparkContext - Error stopping SparkContext after init error.
java.lang.NullPointerException
	at org.apache.spark.SparkContext.stop(SparkContext.scala:1743)
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:567)
	at org.apache.spark.SparkContext$.getOrCreate(SparkContext.scala:2278)
	at org.apache.spark.sql.SparkSession$Builder$$anonfun$8.apply(SparkSession.scala:831)
	at org.apache.spark.sql.SparkSession$Builder$$anonfun$8.apply(SparkSession.scala:823)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.SparkSession$Builder.getOrCreate(SparkSession.scala:823)
	at youe.data.scala.drivers.EtlDriver2$.<init>(EtlDriver2.scala:23)
	at youe.data.scala.drivers.EtlDriver2$.<clinit>(EtlDriver2.scala)
	at youe.data.service.job.TaskUtil$.<init>(TaskUtil.scala:22)
	at youe.data.service.job.TaskUtil$.<clinit>(TaskUtil.scala)
	at youe.data.service.job.DataHandler$$anonfun$receive$1.applyOrElse(DataHandler.scala:44)
	at akka.actor.Actor$class.aroundReceive(Actor.scala:484)
	at youe.data.service.job.DataHandler.aroundReceive(DataHandler.scala:17)
	at akka.actor.ActorCell.receiveMessage(ActorCell.scala:526)
	at akka.actor.ActorCell.invoke(ActorCell.scala:495)
	at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:257)
	at akka.dispatch.Mailbox.run(Mailbox.scala:224)
	at akka.dispatch.Mailbox.exec(Mailbox.scala:234)
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
